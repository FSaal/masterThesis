%\pagestyle{fancy}
\chapter{Background}
\label{ch:Background}

\section{Mathematical}
\todoin{E. g.
	\begin{itemize}
	\item Vector projection
    \item Quaternions
    \item Rotation matrix
\end{itemize}
}



\section{Sensors}
\subsection{\glsentrytext{imu}}
An \acrfull{imu} is used to track the orientation and position of an object.
Common uses are in the aerospace or automotive industry, often in combination with other sensors, to give information about the pose and position of a vehicle.
More recently with the invention of \acrfull{mems} and specifically \acrshort{mems}-\acrshort{imu}s which allow for a very small form factor at a low cost, \acrshort{imu}s are also used in consumer electronics such as smartphones or fitness tracker.
An \acrshort{imu} usually consists of the three following sensors.
The acceleration is measured using an accelerometer and can be used to determine the velocity and the covered distance by integrating the acceleration with respect to time once respectively twice.
The gyroscope gives information about the change of orientation.
Often times a magnetometer is used as well, which is able to measure the earth's magnetic field and is used to correct the measurements of the gyroscope.
It allows for the determination of the absolute heading, whereas the gyroscope can only measure relative change. But because it is very sensitive to other magnetic objects, it is often omitted.
\acrshort{imu}s can be typically divided into the two following categories.

In the first type, the stable platform systems, the inertial sensors are mounted in such way, that they are always aligned with the reference frame.
This is achieved using gimbals, which allow movement along all three axes.
The gyroscopes on the platform measure the rotation and send them to torque motors, which rotate the gimbals to keep the platform in alignment with the reference frame.
The advantage of stable platform systems is that the calculation of orientation and position is straight forward.
The angles of the gimbals can be measured to get the orientation and to get the position, the accelerometer measurements have to be be corrected for gravity (which is \SI{9.8}{\metre\per\second^2} in upward direction) and be integrated two times.
No coordinate transformation is necessary.
The disadvantages are that the mechanical structure of the setup is complex, needs regular maintenance, requires a lot of space and has high costs.

The second type are strapdown systems, which are mostly used today. \todo{reference?}
As the name suggests all the parts are fixed onto the device and are thus not anymore always aligned with the reference frame.
Advantages are that due to the lack of gimbals and motors a significantly smaller build is possible and lower production costs can be achieved.
A disadvantage is that the calculation of the orientation and position is more complex, the rate gyroscopes have to be integrated to get the orientation and can then be used to transform the accelerometer signals into the reference frame.
But with the decrease of computational cost this disadvantages continues to diminish. And even though they are continually improved, the accuracy does not quite match the of stable platform systems.

There are many different types of gyroscopes and accelerometers such as mechanical, optical or solid state, but only the functionality of \acrshort{mems} will be described, because those will also be used in the experiment.
Information about the working principle of other systems and also much more information about \acrshort{imu}s in general can be found in \cite{Woodman07anintroduction}.

\acrshort{mems} consist of electrical and/or mechanical components in the size of \SI{100}{\nano\metre} to \SI{1}{\milli\metre}, allowing for a very small form factor.
Other characteristics of \acrshort{mems} are that they can easily be mass produced allowing for low cost and usually also need less power than traditional systems, because everything is integrated on the chip \cite{Shaeffer2013}.
Almost all consumer grade electronics uses \acrshort{mems}-\acrshort{imu}s nowadays, but they also find more and more use in many industry segments, as their accuracy continues to improve \cite{Perlmutter2016}.


\subsubsection{\glstext{mems} Accelerometer}
\begin{figure}[htb]
	\centering
	%todo Better quality or create own fig
	\includegraphics[width=0.7\linewidth]{MEMS_Accelerometer}
	\caption{Micro structure of a \acrshort{mems} accelerometer }
	\label{fig:MEMS_Accelerometer}
\end{figure}
The accelerometer is used to measure the acceleration.
Besides dynamic acceleration there is the static and constant gravity acceleration on earth in upward direction.
This allows for the determination of one axis of the \acrshort{imu}, even if it is not moving.
Often times only the dynamic accelerations are of interest and to get them the acceleration data during stand still must be measured and subtracted.
The micro structure of a \acrshort{mems} accelerometer is shown in figure \ref{fig:MEMS_Accelerometer}.
A mass is suspended by springs along one axis and if an acceleration along this axis occurs, the mass moves in the opposite direction due to Newton's second law.
The mass has little fingers perpendicular to the moving direction axis, which affect the capacity between the fixed plates.
The change of capacity and thus voltage can be measured, from which the acceleration can be calculated.
To be able to measure the acceleration along all three axis the same setup is used three times, perpendicular to each other.

\subsubsection{\glstext{mems} Gyroscopes}
A gyroscope measures the angular velocity.
The setup of a \acrshort{mems} gyroscope is similar to that of a \acrshort{mems} accelerometer.
A proof mass is suspended on a frame and responds to an input force.
\acrshort{mems} gyroscopes make use of the Coriolis effect, which states that an rotating object with the angular velocity $w$ of mass $m$ and velocity $v$ experiences a force
\[ F_C = -2m(w\times v). \]
To measure the effect, a mass is vibrating along one axis, which in turn is also suspended.
If the mass is oscillating along one axis and a rotation is applied, a second oscillation on the axis perpendicular to the rotation axis can be observed.
E.g.\ if the mass oscillates along the x-axis and a rotation around the z-axis is applied, a vibration along the y-axis can be observed.
By measuring the amplitude and phase of the secondary oscillation the absolute value and direction of the angular velocity can be calculated.
While \acrshort{mems} gyroscopes do not achieve the same accuracy as optical gyroscopes they offer many advantages such as smaller physical properties (weight and size), lower power consumption and startup time as well as a significantly lower cost.
Optical gyroscopes cost in the range of \$10,000 whereas \acrshort{mems} gyroscopes can cost as little as \$3 \cite{Perlmutter2016}.
But this comes at the cost of a worse angle drift which increases from 0.01 to 0.1 deg/h for optical gyroscopes to 10 deg/h \todo{check what type of deg/h there are, daytoday vs in-run} for \acrshort{mems}-\acrshort{imu}s.
\acrshort{mems} gyroscopes have replaced other gyroscope types in most areas, but in areas where the highest precision possible is necessary, typically in military industry, optical gyroscopes are still used today.

\subsubsection{(\glstext{mems}) Magnetometer}
\itodo{Sth sth lorenz (short because not used)}
The disadvantages are that the magnetometer is easily influenced by other ferromagnetic material and electronic devices.
Therefore indoor use while getting reliable data is rarely possible.

\subsubsection{Typical \glstext{mems} errors}
Maybe a sentence about idc about problems, because raw measurements are mostly used.
The first type of errors are calibration errors, which can be eliminated.
Common calibration errors are a constant bias (offset), scaling or misalignment (axes are not orthogonal to each other).
The turn-on bias is different each time the \acrshort{imu} starts up, but can be removed as well.
\todoin{
  \begin{itemize}
	\item Calibration errors
	\item Turn-On Bias
	\item Bias instability
	\item Bias Correction methods
	\item VERY BRIEF
	\item maybe as table
  \end{itemize}}


\subsection{\glsentrytext{lidar}}
\begin{figure}[htb]
	\centering
	\includegraphics[width=0.5\textwidth]{Lidar.png}
	\caption{Setup of a mechanical spinning \acrshort{lidar} \cite{Li2020}}
	\label{fig:lidar}
\end{figure}
\acrfull{lidar} is a method to measure distance to objects.
Similar to other systems such as \acrfull{sonar} or \acrfull{radar}, \acrshort{lidar} uses the time-of-flight principle.
A short laser pulse with the velocity $v$ is sent into the environment and the reflected light is analyzed.
The duration $\Delta t$ it took from sending to receiving can then be used to calculate the distance $s$ with
\[ s = v\frac{\Delta t}{2}. \]
The change of intensity and wavelength of the returning light are measured as well and can provide information about the reflectivity of the object (intensity) or the chemical composition of the air (wavelength).
Common uses of \acrshort{lidar} are the analysis of earth's atmosphere, 3D mapping of environments or in the field of autonomous driving for object detection, tracking and \acrshort{slam}.
Basically all applications which use \acrshort{radar} can also be used with a \acrshort{lidar} instead, allowing for a greater accuracy.\\
There are different \acrshort{lidar} types but the principles are similar.
A transmitter generates a signal and sends it into the environment using a scanning system and a transmission optic.
As transmitter a laser with a wavelength of \SIrange{850}{950}{\nano\metre} (near-infrared) is typically used.
The scanning system allows the laser to explore a large area instead of only a single point by steering the light at different azimuths and vertical angles and can be divided in mechanical spinning or solid state systems.
Mechanical spinning systems is the oldest technology and is still mainly used today.
A mirror which can be rotated around an axis is used, allowing for a greater vertical \acrfull{fov}.
Also the whole \acrshort{lidar} base on which the laser is mounted can be rotated independently from the mirror, allowing for a \SI{360}{\degree} horizontal \acrshort{fov}.
To get a sufficient resolution the \acrshort{lidar} has to spin at a high speed, but some \acrshort{lidar}s also use additionally a vertical array of lasers instead of only one to further increase the density of the generated point cloud.
The working principle of a \acrshort{lidar} using the mechanical spinning method is shown in figure \ref{fig:lidar}.
While mechanical spinning systems are very precise, they are bulky, need a lot of power and are expensive.

Solid state systems and especially \acrshort{mems} \acrshort{lidar}s try to overcome those problems.
\acrshort{mems} \acrshort{lidar} are quasi-static, the only part that moves is the on the chip embedded mirror, but due to the small size (\SIrange{1}{7}{\milli\metre} diameter) very little power has to be used to move it.
They can be rotated on up to two axes, but because the laser cannot be rotated a horizontal view of 360° is not possible \todo{fact check, might have understood it wrong}.
But advantages compared to mechanical systems are the smaller former factor and lower cost.

After transmitting the laser signal the reflected light passes through the receiving optic and is received by photodetectors.
A processing unit then generates a 3D point cloud from all the received measurements.
\itodo{Sort citations and maybe add some more}
\cite{Wang2020}
\cite{Vaughan2006}


\subsection{Odometer?}
\todoin{\begin{itemize}
	\item Induktive Drehzahlsensoren
	\item Differentielle Hall-Sensoren
\end{itemize}
}
\subsubsection{Inductive}
asd


\subsection{Camera?}
\itodo{Probably not necessary, as everyone knows what a camera is}



\section{ROS}
\todoin{Brief introduction to ROS}



\section{Sensor Fusion stuff?}
\todoin{Could also just be explained in methods}



\section{Signal processing}
\dots is necessary.
\dots can be divided into filtering and smoothing.
Filtering can be used in live applications and produces an estimate of the current value by taking the past values into account, whereas smoothing uses past and future samples and thus introduces a delay if used on live data \todo{filtering also often introduces a delay}.
Because the detection should be live, only the filtering methods will be examined.
\itodo{How much about dsp? E.g. also noise, aa etc or only type of filters?}
Digital filters can be generally divided into two different categories.
\acrfull{fir} filter rely on a fixed number of recent input values. An example would be the moving average filter, which takes the past $n$ values into account.
\acrfull{iir} filter rely on previous output as well as most recent input by summing all points with a certain weight (e.g. exponential filter).
This also explains the naming of the two types, the \acrshort{fir} filter "forgets" past values, whereas the \acrshort{iir} filter uses the previous estimate and thus theoretically takes all past values into account.\\
Savitzky-Golay filter
\begin{equation}
	y = \frac{1}{h}\sum_{i =\frac{1 - m}{2}}^{\frac{m - 1}{2}}C
\end{equation}